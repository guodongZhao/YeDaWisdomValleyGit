<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="format-detection" content="telephone=no"><!-- 禁止IPHONE识别手机号码 -->
<meta name="viewport" content="width=device-width,user-scalable=no, initial-scale=1">
<title>编辑房屋</title>
<!-- css -->
<link rel="stylesheet" type="text/css" href="css/index.css">
<link rel="stylesheet" type="text/css" href="css/mui.min.css" />
<link href="css/foundation-datepicker.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../css/aui.css">
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/aui-toast.js"></script>
<script type="text/javascript" src="../script/H.js"></script>
<script type="text/javascript" src="../script/jquery.js"></script>
<script type="text/javascript" src="../script/yuming.js"></script>
<style>
.module-content{padding-top: 44px;padding-bottom: 50px;}
.hybt{color: #000;font-size: 16px;line-height: 40px;}
.hyxz{background: #f4f4f4;border-top-left-radius: 10px;border-top-right-radius: 10px;padding: 10px 15px;}

.yyr{border-radius: 10px;overflow: hidden;}
.yyr li{display: flex;background: #fff;align-items: center;padding:5px 10px;border-bottom: 1px solid #f1f1f1;}
.yyr li:last-child{border-bottom: 0;}
.yyr li span{font-size: 14px;color: #333;width: 130px;}
.yyr li select{font-size: 14px;}
.yyr li input{border: 0;font-size: 14px;color: #000;}
.yyr li p{line-height: 21px; width: 100%; height: 40px;padding: 10px 15px;display: flex;align-items: center;}
.yyr li label{margin-right: 20px;}
.yyr li label input{margin-right: 5px;}
.yyr p{line-height: 44px;color: #000;font-size: 14px;}
.hyxz textarea{border-radius: 10px;border: 0;color: #000;font-size: 14px;}
.hyxz textarea::-webkit-input-placeholder{color: #333;}
.tjsq{display: block;text-align: center; line-height: 40px;margin-top: 10px; color:#fff;font-size: 14px; border-radius: 10px;background: linear-gradient(to right, #367ff8 , #556dff);}
</style>
</head>
<body style="background: #f7f7f7;">
	<header id="headj">
		<a>
			<img src="images/back_jt.png" onclick="api.closeWin()" />
			<span onclick="api.closeWin()">编辑房屋</span>
		</a>
	</header>
<div class="module-content" id="ge">
	<div class="hyxz">
		<ul class="yyr" id="ct">

		</ul>
		<p class="hybt">备注</p>
		<textarea placeholder="" id="bz"></textarea>

	<a class="tjsq" onclick="tijiao()">确定修改</a>

	</div>
</div>

<div class="foot_menu" style="display:none">
	<ul>
		<li>
			<a href="index.html">
				<i><img src="images/menu_icon01.png"></i>
				<span>首 页</span>
			</a>
		</li>
		<li class="cur">
			<a href="wuye.html">
				<i><img src="images/menu_icon02.png"></i>
				<span>智 能</span>
			</a>
		</li>
		<li>
			<a href="news.html">
				<i><img src="images/menu_icon03.png"></i>
				<span>消 息</span>
			</a>
		</li>
		<li>
			<a href="user.html">
				<i><img src="images/menu_icon04.png"></i>
				<span>我 的</span>
			</a>
		</li>
	</ul>
</div>
</body>
<script src="js/jquery-1.11.3.min.js"></script>
<script src="js/foundation-datepicker.js"></script>
<script src="js/locales/foundation-datepicker.zh-CN.js"></script>
<script>
$('#demo-1').fdatepicker();
$('#demo-2').fdatepicker();
</script>
</html>
<script type="text/javascript">
//alert(1)
apiready = function () {
	//alert(JSON.stringify(api.pageParam.arr))
$api.fixStatusBar(document.getElementById('headj'));
document.getElementById('headj').style.height=(50+api.safeArea.top)+'px'
document.getElementById('ge').style.marginTop=(5+api.safeArea.top)+'px'



function xt(){
	//alert(JSON.stringify(api.pageParam.arr))
	html=''
  html+= 	'<li><span>房屋类型</span><input type="text" value="分配" readonly="readonly" id="demo-1"/></li>'
html+='	<li><span>房间序号</span><input type="text" value="'+api.pageParam.arr.roomid+'" placeholder="请填写房间序号" id="roomid"/></li>'
	  html+='	<li style="display:none"><span>数据区分序号</span><input type="text" value="'+api.pageParam.arr.companyid+'" placeholder="请填写数据区分序号" id="companyid"/></li>'
	  html+='	<li style="display:none"><span>承租方序号</span><input type="text" value="'+api.pageParam.arr.tenantryid+'" placeholder="请填写承租方序号" id="tenantryid"/></li>'
	  html+='	<li><span>交付钥匙</span><p><label><input type="radio" name="key" checked="checked" value="1" id="isHaveKey1" />是</label><label><input type="radio" value="2" id="isHaveKey2" name="key" />否</label></p></li>'
	  html+='	<li><span>开始时间</span><input type="date" value="'+api.pageParam.arr.starttime.split(' ')[0]+'" placeholder="请选择开始时间"  id="starttime"/></li>'
	  html+='	<li><span>结束时间</span><input type="date" value="'+api.pageParam.arr.endtime.split(' ')[0]+'" placeholder="请选择结束时间" id="endtime"></li>'


	document.getElementById('ct').innerHTML=html
	document.getElementById('bz').value=api.pageParam.arr.remark
	if(api.pageParam.arr.isHaveKey==1){
		document.getElementById('isHaveKey1').checked=true
	}else {
		document.getElementById('isHaveKey2').checked=true
	}

}
xt()

//showDefault()
}
jy=0
function tijiao(){
  //alert(document.getElementById('nyr').value)
/*14.4修改房间租赁信息
id	int
companyid	String
distributionid	String
starttime	DateTime?
endtime	DateTime?
roomid	Int
remark	String
isHaveKey	String
isHaveKey	String	是否交付钥匙	是	否*/
ish=1
if(document.getElementById('isHaveKey1').checked){
	ish=1
}else {
	ish=2
}
	if(jy==0){
		jy=1
		showDefault()
	//	alert(document.getElementById('roomid').value)
		api.ajax({
						 url: yuming+'/learun/adms/Roomdistribution/updateroomdistribution',
						 method: 'post',
						 data:{values: {
               "loginMark": api.deviceId,
               "token": $api.getStorage('token'),
								 id	:api.pageParam.arr.id,
	 						companyid	:document.getElementById('companyid').value,
	 						distributionid:api.pageParam.arr.distributionid,
	 						starttime	:document.getElementById('starttime').value,
	 						endtime	:document.getElementById('endtime').value,
	 						roomid	:document.getElementById('roomid').value,
	 						remark:document.getElementById('bz').value,
	 						isHaveKey	:ish


								}}
				 }, function(ret) {

	//alert(JSON.stringify(ret))
	 toast.hide()
				 if(ret){
				 if(ret.code==200){
					 api.sendEvent({
					     name: 'sx',
					     extra: {
					         key1: 'value1',
					         key2: 'value2'
					     }
					 });

					 api.toast({
					 msg: '提交成功!',
					 duration: 2000,
					 location: 'middle'
					 });
					toast.hide()
jy=0
		 }else {
       jy=0
			 toast.hide()
			 api.toast({
			 msg: ret.info,
			 duration: 2000,
			 location: 'middle'
	 });
		 }

				 }else {

						toast.hide()
					 api.toast({
					 msg: '网络错误',
					 duration: 2000,
					 location: 'middle'
			 });
				 }

				 })
	}
}
function shanchu(data){


    $("#dialog").addClass("show");
}
function quxiao(data){


    $("#dialog").removeClass("show");
}
function queding(){
  $("#dialog").removeClass("show");
  //alert(document.getElementById('nyr').value)
//  return
  /*求地址：/learun/adms/watermeter/updatewatermeter
  类型：POST
  请求参数：
  参数名称	类型	备注	必须
  id	int	序号	是
  dvalue	String	电表读数	是
  year	String	年	是
  month	String	月	是
  day	String	日	是
  companyid	String	数据区分序号	否
  costitemid	int	成本项目ID	否
  remark	String	备注	否
  newvalue	String	本次表读数	是
  userno	String	业主编号	否
  status	String	电表状态(1:正常,0:异常)只有0或1	是
  commadd	String	电表编号	是
  lastvalue	String	上次表读数	否
  lastdate	String	上次表读日期	否
  newdate	String	本次表读日期	是*/
	if(jy==0){
		jy=1
		showDefault()
		api.ajax({
						 url: yuming+'/learun/adms/Electricitymeter/delelectricitymeter',
						 method: 'post',
						 data:{values: {
               "loginMark": api.deviceId,
               "token": $api.getStorage('token'),
               id	:api.pageParam.id,


								}}
				 }, function(ret) {

	//alert(JSON.stringify(ret))
	 toast.hide()
				 if(ret){
				 if(ret.code==200){
					 api.toast({
					 msg: '删除成功!',
					 duration: 2000,
					 location: 'middle'
					 });
					toast.hide()
          api.sendEvent({
              name: 'sx',
              extra: {
                  key1: 'value1',
                  key2: 'value2'
              }
          });

          setTimeout(function(){
            api.closeWin();

          },1000)

jy=0
		 }else {
       jy=0
			 toast.hide()
			 api.toast({
			 msg: ret.info,
			 duration: 2000,
			 location: 'middle'
	 });
		 }

				 }else {

						toast.hide()
					 api.toast({
					 msg: '网络错误',
					 duration: 2000,
					 location: 'middle'
			 });
				 }

				 })
	}
}
</script>
